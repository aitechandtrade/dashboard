<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title-text">NEON HUD</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root { 
            --neon-blue: #00f3ff;
            --neon-pink: #bc13fe;
            --glass: rgba(15, 15, 25, 0.9);
            --border: 1px solid rgba(255, 255, 255, 0.1);
            --bg-gradient-1: #0f0c29;
            --bg-gradient-2: #302b63;
        }
        
        body { 
            margin: 0; padding: 20px; height: 100vh; box-sizing: border-box;
            background: linear-gradient(-45deg, var(--bg-gradient-1), var(--bg-gradient-2), #24243e, #141e30);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: white; font-family: 'Rajdhani', sans-serif;
            display: grid; 
            grid-template-columns: 360px 1fr; 
            grid-template-rows: 160px 200px 1fr; 
            gap: 20px;
        }

        /* Themes */
        body.theme-matrix { --neon-blue: #00ff41; --neon-pink: #008F11; --bg-gradient-1: #000000; --bg-gradient-2: #0a0a0a; }
        body.theme-cyberpunk { --neon-blue: #ffee00; --neon-pink: #00f3ff; --bg-gradient-1: #2b002b; --bg-gradient-2: #590059; }
        body.theme-red { --neon-blue: #ff0000; --neon-pink: #ff4444; --bg-gradient-1: #2b0000; --bg-gradient-2: #590000; }

        @keyframes gradientBG { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }

        .hud-box { 
            background: var(--glass);
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: var(--border);
            border-radius: 16px;
            padding: 20px;
            display: flex; flex-direction: column;
            position: relative; overflow: hidden;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
            transition: border-color 0.3s ease;
        }
        
        /* CLOCK */
        #clock-box { justify-content: center; align-items: center; border-left: 4px solid var(--neon-blue); }
        #clock { font-family: 'Orbitron', sans-serif; font-size: 4rem; font-weight: 900; line-height: 1; text-shadow: 0 0 20px rgba(255,255,255,0.2); }
        #date { font-size: 1.2rem; letter-spacing: 2px; color: var(--neon-blue); text-transform: uppercase; margin-top: 10px; }

        /* REMOTE */
        #media-box { border-left: 4px solid var(--neon-pink); justify-content: space-between; }
        .control-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; grid-template-rows: 1fr 1fr; gap: 10px; height: 100%; margin-top: 10px; }
        .btn { border: none; border-radius: 8px; color: white; font-size: 1.5rem; cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: center; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255,255,255,0.1); }
        .btn:active { transform: scale(0.95); background: rgba(255,255,255,0.2); }
        .btn-play { grid-column: 2; background: rgba(255, 255, 255, 0.1); border-color: var(--neon-blue); color: var(--neon-blue); font-size: 2rem; }
        .btn-mute { color: var(--neon-pink); opacity: 0.7; }

        /* NOTES */
        #notes-box { grid-row: 3 / 4; border-top: 4px solid #fff; display: flex; flex-direction: column; }
        h3 { margin: 0 0 10px 0; font-family: 'Orbitron'; letter-spacing: 2px; font-size: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px; flex-shrink: 0; }
        #notes-container { flex-grow: 1; overflow-y: auto; padding-right: 5px; display: flex; flex-direction: column; gap: 10px; }
        .note { background: rgba(255,255,255,0.1); padding: 12px; border-radius: 8px; border-left: 3px solid var(--neon-blue); font-size: 1.1rem; line-height: 1.4; flex-shrink: 0; }

        /* CALENDAR */
        #calendar-box { grid-column: 2 / 3; grid-row: 1 / 4; padding: 0; border: none; background: transparent; }
        iframe { width: 100%; height: 100%; border-radius: 16px; border: 1px solid rgba(255,255,255,0.1); filter: invert(1) hue-rotate(180deg) contrast(0.9) brightness(0.9); }
    </style>
</head>
<body>

    <div class="hud-box" id="clock-box">
        <div id="clock">12:00</div>
        <div id="date">SYSTEM READY</div>
    </div>

    <div class="hud-box" id="media-box">
        <div style="font-family:'Orbitron'; color:var(--neon-pink); display:flex; justify-content:space-between;">
            <span>COMMAND DECK</span> <i class="fas fa-wifi"></i>
        </div>
        <div class="control-grid">
            <button class="btn" onclick="remoteCmd('previous')"><i class="fas fa-step-backward"></i></button>
            <button class="btn btn-play" onclick="remoteCmd('play')"><i class="fas fa-play"></i></button>
            <button class="btn" onclick="remoteCmd('next')"><i class="fas fa-step-forward"></i></button>
            <button class="btn" onclick="remoteCmd('volume_down')"><i class="fas fa-volume-down"></i></button>
            <button class="btn btn-mute" onclick="remoteCmd('mute')"><i class="fas fa-volume-mute"></i></button>
            <button class="btn" onclick="remoteCmd('volume_up')"><i class="fas fa-volume-up"></i></button>
        </div>
    </div>

    <div class="hud-box" id="notes-box">
        <h3 id="notes-title">MISSION LOG</h3>
        <div id="notes-container"></div>
    </div>

    <div class="hud-box" id="calendar-box">
        <iframe id="calendar-frame" src="https://calendar.google.com/calendar/embed?src=abdullahimtiazalishaikh%40gmail.com&ctz=Asia%2FDubai&showTitle=0&showNav=0&showDate=0&showPrint=0&showTabs=0&showCalendars=0"></iframe>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
        import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDC33-WXrZ50uHjjLlW9qhwT7REdSQ6M3s",
            authDomain: "mydashboard-13727.firebaseapp.com",
            databaseURL: "https://mydashboard-13727-default-rtdb.firebaseio.com",
            projectId: "mydashboard-13727",
            storageBucket: "mydashboard-13727.firebasestorage.app",
            messagingSenderId: "389525920980",
            appId: "1:389525920980:web:902256a3b7ca93b657ef41"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // 1. Remote Control
        window.remoteCmd = (action) => {
            set(ref(db, 'media'), { action: action, timestamp: Date.now() });
        };

        // 2. Clock
        setInterval(() => {
            const now = new Date();
            let h = now.getHours(); const ampm = h >= 12 ? 'PM' : 'AM'; h = h % 12; h = h ? h : 12; 
            const m = now.getMinutes().toString().padStart(2, '0');
            document.getElementById('clock').innerText = `${h}:${m} ${ampm}`;
            document.getElementById('date').innerText = now.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' });
        }, 1000);

        // 3. Notes Sync
        onValue(ref(db, 'notes'), (snap) => {
            const container = document.getElementById('notes-container');
            container.innerHTML = ''; 
            if(snap.exists()) {
                const notes = [];
                snap.forEach(child => notes.push(child.val())); 
                notes.reverse().forEach(obj => {
                    const d = document.createElement('div');
                    d.className = 'note';
                    d.innerText = typeof obj === 'object' ? obj.text : obj; 
                    container.appendChild(d);
                });
            }
        });

        // 4. Listen for Settings Changes (Theme, Title, etc.)
        onValue(ref(db, 'settings'), (snap) => {
            if (snap.exists()) {
                const s = snap.val();
                if (s.pageTitle) document.getElementById('page-title-text').textContent = s.pageTitle;
                if (s.notesTitle) document.getElementById('notes-title').textContent = s.notesTitle;
                
                // Update accent color
                if (s.accentColor) document.documentElement.style.setProperty('--neon-blue', s.accentColor);
                
                // Update theme class
                document.body.className = ''; // Reset
                if (s.theme && s.theme !== 'default') document.body.classList.add(`theme-${s.theme}`);

                // Update Calendar if changed
                if (s.calendarUrl) {
                    const frame = document.getElementById('calendar-frame');
                    if (frame.src !== s.calendarUrl) frame.src = s.calendarUrl;
                }
            }
        });
    </script>
</body>
</html>
